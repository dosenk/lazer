<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<!--    <script>-->
<!--        ws = new WebSocket("wss://mayak.net:8003");-->
<!--        ws.onmessage = function(evt) {alert(evt.data);};-->
<!--    </script>-->
    <script>
        var socket;

        function init(){
            var host = "wss://192.168.100.203:8003";
            try{
                socket = new WebSocket(host);
                log('WebSocket - status '+socket.readyState+ '</br>');

                socket.onopen    = function(msg){ log("Welcome - status "+this.readyState+ '</br>'); };
                socket.onmessage = function(msg){ log("Received: "+msg.data+ '</br>'); };
                socket.onclose   = function(msg){ log("Disconnected - status "+this.readyState); };
            }
            catch(ex){ log(ex); }
            $("msg").focus();
        }

        function send(){
            var txt,msg;
            txt = $("msg");
            msg = txt.value;
            if(!msg){ alert("Message can not be empty"); return; }
            txt.value="";
            txt.focus();
            try{ socket.send(msg); log('Sent: '+msg+ '</br>'); } catch(ex){ log(ex); }
        }
        function quit(){
            log("Goodbye!");
            socket.close();
            socket=null;
        }

        // Utilities
        function $(id){ return document.getElementById(id); }
        function log(msg){ $("log").innerHTML+="\n"+msg; }
        function onkey(event){ if(event.keyCode==13){ send(); } }
    </script>
</head>
<body onload="init()">
<h3>WebSocket v2.00</h3>
<div id="log"></div>
<input id="msg" type="textbox" onkeypress="onkey(event)"/>
<button onclick="send()">Send</button>
<button onclick="quit()">Quit</button>
<!--<div>Commands: hello, hi, name, age, date, time, thanks, bye</div>-->
</body>
</html>